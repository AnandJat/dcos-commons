<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">







<head>
<title>Cassandra: Node Settings</title>
<link rel="stylesheet" type="text/css" media="all" href="../../style/gh-basic.css" />
<link rel="shortcut icon" type="image/png" href="https://mesosphere.com/favicon.ico"/>
<!-- The Dropdown library is written by Stephen Morley, licensed CC0 1.0 Universal (Public Domain Dedication)-->
<link rel="stylesheet" type="text/css" media="all" href="../../style/Dropdown.css" />
<script src="../../style/Dropdown.js"></script>
<style type="text/css">
/* set the background color of menu items */
.dropdown, .dropdown ul { background: #555555; clear: both; }
/* set the background color of active items */
.dropdown li:hover > a, .dropdown li:hover > span, .dropdown li.dropdownOpen > a, .dropdown li.dropdownOpen > span { background: #af87e0; }
/* pad items, set their text color, and fade their background color */
.dropdown a, .dropdown span { padding: 0.25em 0.5em; color: white; transition: background 0.2s; }
/* show '+' on expandable items */
.dropdown span:after { content: " +"; }

/* toc style: remove extra margin between elements */
#markdown-toc ul { margin: 0; }
</style>
</head>

<body>
<div id="wrapper">

<a href="../..">
<img style="float: left; margin-bottom: 2em" src="https://mesosphere.com/wp-content/themes/mesosphere/library/images/assets/dcos-sdk-logo.png" width="250" alt="DC/OS Software Development Kit" />
</a>
<img style="float: right" src="https://img.shields.io/badge/Status-Alpha-BF97F0.svg?style=flat-square" alt="Status: Alpha" />

<ul class="dropdown" style="clear: both">
  <li>
    <a href="../..">Home</a>
  </li>
  <li>
    <span>Documentation</span>
    <ul>
      
      
      
      
      <li><a href="../../developer-guide.html">SDK Developer Guide</a></li>
      
      
      
      <li><a href="../../operations-guide.html">SDK Operations Guide</a></li>
      
      
      
      <li><a href="../../faq.html">Frequently Asked Questions</a></li>
      
      
      
      <li><a href="../../glossary.html">Glossary</a></li>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
    </ul>
  </li>
  <li>
    <span>Tutorials</span>
    <ul>
      
      
      
      <li><a href="../../tutorials/secrets-tutorial.html">Secrets Tutorial</a></li>
      
      <li><a href="../../tutorials/kafka-tutorial.html">Kafka Tutorial</a></li>
      
      <li><a href="../../tutorials/quick-start-java.html">Quick Start (Java)</a></li>
      
    </ul>
  </li>
  <li>
    <span>Reference</span>
    <ul>
      
      
      
      <li><a href="../../reference/yaml-reference.html">YAML Reference</a></li>
      
      <li><a href="../../reference/api">Javadoc Reference</a></li>
      <li><a href="../../reference/swagger-api">REST APIs</a></li>
    </ul>
  </li>
  <li>
    <span>Services</span>
    <ul>
      
      
      
      
      <li>
        
        <span>Elastic</span>
        
        <ul>
          
          
          <li><a href="../../services/elastic/install.html">Install and Customize</a></li>
          
          <li><a href="../../services/elastic/elastic-x-pack.html">X-Pack</a></li>
          
          <li><a href="../../services/elastic/uninstall.html">Uninstall</a></li>
          
          <li><a href="../../services/elastic/quick-start.html">Quick Start</a></li>
          
          <li><a href="../../services/elastic/connecting-clients.html">Connecting Clients</a></li>
          
          <li><a href="../../services/elastic/managing.html">Managing</a></li>
          
          <li><a href="../../services/elastic/api-reference.html">API Reference</a></li>
          
          <li><a href="../../services/elastic/disaster-recovery.html">Disaster Recovery</a></li>
          
          <li><a href="../../services/elastic/troubleshooting.html">Troubleshooting</a></li>
          
          <li><a href="../../services/elastic/limitations.html">Limitations</a></li>
          
          <li><a href="../../services/elastic/supported-versions.html">Supported Versions</a></li>
          
          <li><a href="../../services/elastic/release-notes.html">Release Notes</a></li>
          
          <li><a href="../../services/elastic/upgrade.html">Upgrade</a></li>
          
        </ul>
      </li>
      
      <li>
        
        <span>HDFS</span>
        
        <ul>
          
          
          <li><a href="../../services/hdfs/install.html">Install and Customize</a></li>
          
          <li><a href="../../services/hdfs/uninstall.html">Uninstall</a></li>
          
          <li><a href="../../services/hdfs/quick-start.html">Quickstart</a></li>
          
          <li><a href="../../services/hdfs/connecting-clients.html">Connecting Clients</a></li>
          
          <li><a href="../../services/hdfs/managing.html">Managing</a></li>
          
          <li><a href="../../services/hdfs/api-reference.html">API Reference</a></li>
          
          <li><a href="../../services/hdfs/troubleshooting.html">Troubleshooting</a></li>
          
          <li><a href="../../services/hdfs/limitations.html">Limitations</a></li>
          
          <li><a href="../../services/hdfs/supported-versions.html">Supported Versions</a></li>
          
          <li><a href="../../services/hdfs/release-notes.html">Release Notes</a></li>
          
          <li><a href="../../services/hdfs/upgrade.html">Upgrade</a></li>
          
        </ul>
      </li>
      
      <li>
        
        <span>Kafka</span>
        
        <ul>
          
          
          <li><a href="../../services/kafka/install.html">Install and Customize</a></li>
          
          <li><a href="../../services/kafka/uninstall.html">Uninstall</a></li>
          
          <li><a href="../../services/kafka/quick-start.html">Quick Start</a></li>
          
          <li><a href="../../services/kafka/connecting-clients.html">Connecting Clients</a></li>
          
          <li><a href="../../services/kafka/managing.html">Managing</a></li>
          
          <li><a href="../../services/kafka/api-reference.html">API Reference</a></li>
          
          <li><a href="../../services/kafka/troubleshooting.html">Troubleshooting</a></li>
          
          <li><a href="../../services/kafka/limitations.html">Limitations</a></li>
          
          <li><a href="../../services/kafka/supported-versions.html">Supported Versions</a></li>
          
          <li><a href="../../services/kafka/release-notes.html">Release Notes</a></li>
          
          <li><a href="../../services/kafka/upgrade.html">Upgrade</a></li>
          
        </ul>
      </li>
      
    </ul>
  </li>
  <li><a href="https://github.com/mesosphere/dcos-commons/blob/master/CONTRIBUTING.md">Contributing</a></li>
  <li><a href="http://chat.dcos.io" target="_blank">Slack</a></li>
</ul>
<h1>Cassandra: Node Settings</h1>
<div id="content">
<p>Adjust the following settings to customize the amount of resources allocated to each  node. DC/OS Apache Cassandraâ€™s <a href="http://cassandra.apache.org/doc/latest/operating/hardware.html">system requirements</a> must be taken into consideration when adjusting these values. Reducing these values below those requirements may result in adverse performance and/or failures while using the service.</p>

<p>Each of the following settings can be customized under the <strong>node</strong> configuration section.</p>

<h1 id="node-count">Node Count</h1>

<p>Customize the <code class="highlighter-rouge">Node Count</code> setting (default 3) under the <strong>node</strong> configuration section. Consult the Apache Cassandra documentation for minimum node count requirements.</p>

<ul>
  <li><strong>In DC/OS CLI options.json</strong>: <code class="highlighter-rouge">count</code>: integer (default: <code class="highlighter-rouge">3</code>)</li>
  <li><strong>DC/OS web interface</strong>: <code class="highlighter-rouge">NODES</code>: <code class="highlighter-rouge">integer</code></li>
</ul>

<h1 id="cpu">CPU</h1>

<p>You can customize the amount of CPU allocated to each node. A value of <code class="highlighter-rouge">1.0</code> equates to one full CPU core on a machine. Change this value by editing the <strong>cpus</strong> value under the <strong>node</strong> configuration section. Turning this too low will result in throttled tasks.</p>

<ul>
  <li><strong>In DC/OS CLI options.json</strong>: <code class="highlighter-rouge">cpus</code>: number (default: <code class="highlighter-rouge">0.5</code>)</li>
  <li><strong>DC/OS web interface</strong>: <code class="highlighter-rouge">CASSANDRA_CPUS</code>: <code class="highlighter-rouge">number</code></li>
</ul>

<h1 id="memory">Memory</h1>

<p>You can customize the amount of RAM allocated to each node. Change this value by editing the <strong>mem</strong> value (in MB) under the <strong>node</strong> configuration section. Turning this too low will result in out of memory errors. The <code class="highlighter-rouge">heap.size</code> setting must also be less than this value to prevent out of memory errors resulting from the Java Virtual Machine attempting to allocate more memory than is available to the Cassandra process.</p>

<ul>
  <li><strong>In DC/OS CLI options.json</strong>: <code class="highlighter-rouge">mem</code>: integer (default: <code class="highlighter-rouge">10240</code>)</li>
  <li><strong>DC/OS web interface</strong>: <code class="highlighter-rouge">CASSANDRA_MEMORY_MB</code>: <code class="highlighter-rouge">integer</code></li>
</ul>

<h1 id="jmx-port">JMX Port</h1>

<p>You can customize the port that Apache Cassandra listens on for JMX requests, such as those issued by <code class="highlighter-rouge">nodetool</code>.</p>

<ul>
  <li><strong>In DC/OS CLI options.json</strong>: <code class="highlighter-rouge">jmx_port</code>: integer (default: <code class="highlighter-rouge">7199</code>)</li>
  <li><strong>DC/OS web interface</strong>: <code class="highlighter-rouge">TASKCFG_ALL_JMX_PORT</code>: <code class="highlighter-rouge">integer</code></li>
</ul>

<h1 id="storage-port">Storage Port</h1>

<p>You can customize the port that Apache Cassandra listens on for inter-node communication.</p>

<ul>
  <li><strong>In DC/OS CLI options.json</strong>: <code class="highlighter-rouge">storage_port</code>: integer (default: <code class="highlighter-rouge">7000</code>)</li>
  <li><strong>DC/OS web interface</strong>: <code class="highlighter-rouge">TASKCFG_ALL_CASSANDRA_STORAGE_PORT</code>: <code class="highlighter-rouge">integer</code></li>
</ul>

<h1 id="ssl-storage-port">SSL Storage Port</h1>

<p>You can customize the port that Apache Cassandra listens on for inter-node communication over SSL.</p>

<ul>
  <li><strong>In DC/OS CLI options.json</strong>: <code class="highlighter-rouge">ssl_storage_port</code>: integer (default: <code class="highlighter-rouge">7001</code>)</li>
  <li><strong>DC/OS web interface</strong>: <code class="highlighter-rouge">TASKCFG_ALL_CASSANDRA_SSL_STORAGE_PORT</code>: <code class="highlighter-rouge">integer</code></li>
</ul>

<h1 id="native-transport-port">Native Transport Port</h1>

<p>You can customize the port that Apache Cassandra listens on for CQL queries.</p>

<ul>
  <li><strong>In DC/OS CLI options.json</strong>: <code class="highlighter-rouge">native_transport_port</code>: integer (default: <code class="highlighter-rouge">9042</code>)</li>
  <li><strong>DC/OS web interface</strong>: <code class="highlighter-rouge">TASKCFG_ALL_CASSANDRA_NATIVE_TRANSPORT_PORT</code>: <code class="highlighter-rouge">integer</code></li>
</ul>

<h1 id="rpc-port">RPC Port</h1>

<p>You can customize the port that Apache Cassandra listens on for Thrift RPC requests.</p>

<ul>
  <li><strong>In DC/OS CLI options.json</strong>: <code class="highlighter-rouge">rpc_port</code>: integer (default: <code class="highlighter-rouge">9160</code>)</li>
  <li><strong>DC/OS web interface</strong>: <code class="highlighter-rouge">TASKCFG_ALL_CASSANDRA_RPC_PORT</code>: <code class="highlighter-rouge">integer</code></li>
</ul>

<h1 id="disks">Disks</h1>

<h2 id="volume-type">Volume Type</h2>

<p>The service supports two volume types:</p>
<ul>
  <li><code class="highlighter-rouge">ROOT</code> volumes are effectively an isolated directory on the root volume, sharing IO/spindles with the rest of the host system.</li>
  <li><code class="highlighter-rouge">MOUNT</code> volumes are a dedicated device or partition on a separate volume, with dedicated IO/spindles.</li>
</ul>

<p>Using <code class="highlighter-rouge">MOUNT</code> volumes requires <a href="https://docs.mesosphere.com/1.9/storage/mount-disk-resources/">additional configuration on each DC/OS agent system</a>, so the service currently uses <code class="highlighter-rouge">ROOT</code> volumes by default. To ensure reliable and consistent performance in a production environment, you should configure <code class="highlighter-rouge">MOUNT</code> volumes on the machines that will run the service in your cluster and then configure the following as <code class="highlighter-rouge">MOUNT</code> volumes:</p>

<p>To configure the disk type:</p>
<ul>
  <li><strong>In DC/OS CLI options.json</strong>: <code class="highlighter-rouge">disk_type</code>: string (default: <code class="highlighter-rouge">ROOT</code>)</li>
  <li><strong>DC/OS web interface</strong>: <code class="highlighter-rouge">CASSANDRA_DISK_TYPE</code>: <code class="highlighter-rouge">string</code></li>
</ul>

<h2 id="disk-scheduler">Disk Scheduler</h2>

<p>It is <a href="http://docs.datastax.com/en/landing_page/doc/landing_page/recommendedSettings.html#recommendedSettings__optimizing-ssds">recommended</a> that you pre-configure your storage hosts to use the deadline IO scheduler in production environments.</p>

<h1 id="placement-constraints">Placement Constraints</h1>

<p>Placement constraints allow you to customize where Apache Cassandra nodes are deployed in the DC/OS cluster. Placement constraints support all <a href="http://mesosphere.github.io/marathon/docs/constraints.html">Marathon operators</a> with this syntax: <code class="highlighter-rouge">field:OPERATOR[:parameter]</code>. For example, if the reference lists <code class="highlighter-rouge">[["hostname", "UNIQUE"]]</code>, use <code class="highlighter-rouge">hostname:UNIQUE</code>.</p>

<ul>
  <li><strong>In DC/OS CLI options.json</strong>: <code class="highlighter-rouge">placement_constraint</code>: string (default: <code class="highlighter-rouge">""</code>)</li>
  <li><strong>DC/OS web interface</strong>: <code class="highlighter-rouge">PLACEMENT_CONSTRAINT</code>: <code class="highlighter-rouge">string</code></li>
</ul>

<h1 id="virtual-networks">Virtual networks</h1>

<p>Cassandra supports deployment on virtual networks on DC/OS (including the <code class="highlighter-rouge">dcos</code> overlay network) allowing each node to have its own IP address and not use the ports resources on the agent. This can be specified by passing the following configuration during installation:</p>
<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"service"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"virtual_network_enabled"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>
<p>By default two nodes will not be placed on the same agent, however multiple Cassandra clusters can share an agent. As mentioned in the <a href="https://mesosphere.github.io/dcos-commons/developer-guide.html">developer guide</a> once the service is deployed on a virtual network, it cannot be updated to use the host network.</p>

</div>
</div>
</body>

</html>
