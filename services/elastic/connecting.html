<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">







<head>
<title>Elastic: Connecting Clients</title>
<link rel="stylesheet" type="text/css" media="all" href="../../style/gh-basic.css" />
<link rel="shortcut icon" type="image/png" href="https://mesosphere.com/favicon.ico"/>
<!-- The Dropdown library is written by Stephen Morley, licensed CC0 1.0 Universal (Public Domain Dedication)-->
<link rel="stylesheet" type="text/css" media="all" href="../../style/Dropdown.css" />
<script src="../../style/Dropdown.js"></script>
<style type="text/css">
/* set the background color of menu items */
.dropdown, .dropdown ul { background: #555555; clear: both; }
/* set the background color of active items */
.dropdown li:hover > a, .dropdown li:hover > span, .dropdown li.dropdownOpen > a, .dropdown li.dropdownOpen > span { background: #af87e0; }
/* pad items, set their text color, and fade their background color */
.dropdown a, .dropdown span { padding: 0.25em 0.5em; color: white; transition: background 0.2s; }
/* show '+' on expandable items */
.dropdown span:after { content: " +"; }

/* toc style: remove extra margin between elements */
#markdown-toc ul { margin: 0; }
</style>
</head>

<body>
<div id="wrapper">

<a href="../..">
<img style="float: left; margin-bottom: 2em" src="https://mesosphere.com/wp-content/themes/mesosphere/library/images/assets/dcos-sdk-logo.png" width="250" alt="DC/OS Software Development Kit" />
</a>
<img style="float: right" src="https://img.shields.io/badge/Status-Alpha-BF97F0.svg?style=flat-square" alt="Status: Alpha" />

<ul class="dropdown" style="clear: both">
  <li>
    <a href="../..">Home</a>
  </li>
  <li>
    <span>Documentation</span>
    <ul>
      
      
      
      <li><a href="../../operations-guide.html">SDK Operations Guide</a></li>
      
      <li><a href="../../developer-guide.html">SDK Developer Guide</a></li>
      
      <li><a href="../../yaml-reference.html">YAML Reference</a></li>
      
      <li><a href="../../glossary.html">Glossary</a></li>
      
      <li><a href="../../faq.html">Frequently Asked Questions</a></li>
      
      <li><a href="../../ops-guide"></a></li>
      
      <li><a href="../../swagger-api">REST APIs</a></li>
      <li><a href="../../api">Javadoc Reference</a></li>
    </ul>
  </li>
  <li>
    <span>Tutorials</span>
    <ul>
      
      
      
      <li><a href="../../tutorials/data-store-tutorial.html">Data Store Tutorial</a></li>
      
      <li><a href="../../tutorials/kafka-tutorial.html">Kafka Tutorial</a></li>
      
      <li><a href="../../tutorials/automatic-repair.html">Automatic Repair</a></li>
      
      <li><a href="../../tutorials/quick-start-java.html">Quick Start (Java)</a></li>
      
    </ul>
  </li>
  <li>
    <span>Services</span>
    <ul>
      
      
      
      
      <li>
        
        <span>Elastic</span>
        
        <ul>
          
          
          <li><a href="../../services/elastic/install.html">Install and Customize</a></li>
          
          <li><a href="../../services/elastic/quick-start.html">Usage Example</a></li>
          
          <li><a href="../../services/elastic/upgrade.html">Upgrade</a></li>
          
          <li><a href="../../services/elastic/uninstall.html">Uninstall</a></li>
          
          <li><a href="../../services/elastic/configure.html">Configuring</a></li>
          
          <li><a href="../../services/elastic/x-pack.html">X-Pack</a></li>
          
          <li><a href="../../services/elastic/connecting.html">Connecting Clients</a></li>
          
          <li><a href="../../services/elastic/backup_restore.html">Backup and Restore</a></li>
          
          <li><a href="../../services/elastic/managing.html">Managing</a></li>
          
          <li><a href="../../services/elastic/api-reference.html">API Reference</a></li>
          
          <li><a href="../../services/elastic/troubleshooting.html">Troubleshooting</a></li>
          
          <li><a href="../../services/elastic/version_policy.html">Version Policy</a></li>
          
          <li><a href="../../services/elastic/limitations.html">Limitations</a></li>
          
          <li><a href="../../services/elastic/changelog.html">Changelog</a></li>
          
        </ul>
      </li>
      
      <li>
        
        <span>HDFS</span>
        
        <ul>
          
          
          <li><a href="../../services/hdfs/quick-start.html">Quickstart</a></li>
          
          <li><a href="../../services/hdfs/install.html">Install and Customize</a></li>
          
          <li><a href="../../services/hdfs/uninstall.html">Uninstall</a></li>
          
          <li><a href="../../services/hdfs/configure.html">Configuring</a></li>
          
          <li><a href="../../services/hdfs/connecting-clients.html">Connecting Clients</a></li>
          
          <li><a href="../../services/hdfs/limitations.html">Limitations</a></li>
          
          <li><a href="../../services/hdfs/managing.html">Managing</a></li>
          
          <li><a href="../../services/hdfs/api-reference.html">API Reference</a></li>
          
          <li><a href="../../services/hdfs/troubleshooting.html">Troubleshooting</a></li>
          
        </ul>
      </li>
      
      <li>
        
        <span>Kafka</span>
        
        <ul>
          
          
          <li><a href="../../services/kafka/install-and-customize.html">Install and Customize</a></li>
          
          <li><a href="../../services/kafka/quick-start.html">Quick Start</a></li>
          
          <li><a href="../../services/kafka/uninstall.html">Uninstall</a></li>
          
          <li><a href="../../services/kafka/configure.html">Configure</a></li>
          
          <li><a href="../../services/kafka/connecting-clients.html">Connecting Clients</a></li>
          
          <li><a href="../../services/kafka/managing.html">Managing</a></li>
          
          <li><a href="../../services/kafka/api-reference.html">API Reference</a></li>
          
          <li><a href="../../services/kafka/troubleshooting.html">Troubleshooting</a></li>
          
          <li><a href="../../services/kafka/version-policy.html">Version Policy</a></li>
          
          <li><a href="../../services/kafka/limitations.html">Limitations</a></li>
          
        </ul>
      </li>
      
    </ul>
  </li>
  <li><a href="https://github.com/mesosphere/dcos-commons/blob/master/CONTRIBUTING.md">Contributing</a></li>
  <li><a href="http://chat.dcos.io" target="_blank">Slack</a></li>
</ul>
<h1>Elastic: Connecting Clients</h1>
<div id="content">
<h1 id="connecting-clients">Connecting Clients</h1>

<p>The Elasticsearch REST APIs are exposed using JSON over HTTP. You simply send HTTP requests to the appropriate Named VIP, which is essentially a load-balanced name-based service address. By default, the Elastic framework creates an Elasticsearch cluster with one <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-node.html#coordinating-node">coordinator node</a>. Send your requests to this service address as shown in the following examples:</p>

<ol>
  <li>Create an index.</li>
</ol>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>  curl -s -u elastic:changeme -XPUT <span class="s1">'coordinator.elastic.l4lb.thisdcos.directory:9200/customer?pretty'</span>
</code></pre>
</div>

<ol>
  <li>Store and retrieve data.</li>
</ol>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>  curl -s -u elastic:changeme -XPUT <span class="s1">'coordinator.elastic.l4lb.thisdcos.directory:9200/customer/external/1?pretty'</span> -d <span class="s1">'
  {
    "name": "John Doe"
  }'</span>
  curl -s -u elastic:changeme -XGET <span class="s1">'coordinator.elastic.l4lb.thisdcos.directory:9200/customer/external/1?pretty'</span>
</code></pre>
</div>

<p><strong>Note:</strong> If you did not install any coordinator nodes, you should direct all queries to your data nodes instead:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>  curl -s -u elastic:changeme <span class="s1">'data.elastic.l4lb.thisdcos.directory:9200/_cat/nodes?v'</span>
</code></pre>
</div>

<p>The service address varies based on the name you assigned the framework when you installed it.</p>
<div class="highlighter-rouge"><pre class="highlight"><code>&lt;node type&gt;.&lt;framework name&gt;.l4lb.thisdcos.directory:9200
</code></pre>
</div>

<p>The default framework name is <code class="highlighter-rouge">elastic</code>. If you customized the name your framework, you need to adjust the service address accordingly.</p>

<h2 id="kibana">Kibana</h2>

<p><a href="https://www.elastic.co/products/kibana">Kibana</a> lets you visualize your Elasticsearch data and navigate the Elastic Stack. You can install Kibana like any other DC/OS package via the <strong>Universe</strong> &gt; <strong>Packages</strong> tab of the DC/OS web interface or the DC/OS CLI:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>dcos package install kibana
</code></pre>
</div>

<p>This command launches a new Kibana application with the default name <code class="highlighter-rouge">kibana</code> and the default Elasticsearch URL <code class="highlighter-rouge">http://coordinator.elastic.l4lb.thisdcos.directory:9200</code>. Two Kibana application instances cannot share the same name, so installing additional Kibana applications beyond the default one requires customizing the <code class="highlighter-rouge">name</code> at install time for each additional instance.</p>

<h3 id="access-kibana">Access Kibana</h3>

<ol>
  <li>
    <p>Log into your DC/OS cluster so that you can see the Dashboard. You should see your Elastic service and your Kibana service running under Services.</p>
  </li>
  <li>
    <p>Make sure Kibana is ready for use. Depending on your Kibana node’s resources and whether or not you are installing X-Pack, it can take ~10 minutes to launch. If you look in the stdout log for Kibana, you will see this line takes the longest when installing X-Pack:</p>
  </li>
</ol>

<div class="highlighter-rouge"><pre class="highlight"><code>  Optimizing and caching browser bundles...
</code></pre>
</div>

<p>Then you’ll see this:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="w">  </span><span class="p">{</span><span class="nt">"type"</span><span class="p">:</span><span class="s2">"log"</span><span class="p">,</span><span class="nt">"@timestamp"</span><span class="p">:</span><span class="s2">"2016-12-08T22:37:46Z"</span><span class="p">,</span><span class="nt">"tags"</span><span class="p">:[</span><span class="s2">"listening"</span><span class="p">,</span><span class="s2">"info"</span><span class="p">],</span><span class="nt">"pid"</span><span class="p">:</span><span class="mi">12263</span><span class="p">,</span><span class="nt">"message"</span><span class="p">:</span><span class="s2">"Server running at http://0.0.0.0:5601"</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<ol>
  <li>If you installed X-Pack, go to
    <div class="highlighter-rouge"><pre class="highlight"><code>  http://&lt;dcos_url&gt;/service/kibana/login
</code></pre>
    </div>
    <p>and log in with <code class="highlighter-rouge">elastic</code>/<code class="highlighter-rouge">changeme</code>.</p>
  </li>
</ol>

<p>Otherwise go to</p>
<div class="highlighter-rouge"><pre class="highlight"><code>  http://&lt;dcos_url&gt;/service/kibana
</code></pre>
</div>

<h3 id="configuration-guidelines">Configuration Guidelines</h3>

<ul>
  <li>Service name: This needs to be unique for each instance of the service that is running.</li>
  <li>Service user: This must be a non-root user that already exists on each agent. The default user is <code class="highlighter-rouge">nobody</code>.</li>
  <li>The Kibana X-Pack plugin is not installed by default, but you can enable it. See the <a href="x-pack.md">X-Pack documentation</a> to learn more about X-Pack in the Elastic package. This setting must match the corresponding setting in the Elastic package (i.e., if you have X-Pack enabled in Kibana, you must also have it enabled in Elastic).</li>
  <li>Elasticsearch credentials: If you have X-Pack enabled, Kibana will use these credentials for authorization. The default user is  <code class="highlighter-rouge">kibana</code>.</li>
  <li>Elasticsearch URL: This is a required configuration parameter. The default value <code class="highlighter-rouge">http://coordinator.elastic.l4lb.thisdcos.directory:9200</code> corresponds to the named VIP that exists when the Elastic package is launched with its own default configuration.</li>
</ul>

<h3 id="custom-installation">Custom Installation</h3>

<p>You can customize the Kibana installation in a variety of ways by specifying a JSON options file. For example, here is a sample JSON options file that installs X-Pack and customizes the service name and Elasticsearch URL:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"service"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"another-kibana"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"kibana"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"elasticsearch_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://my.elasticsearch.cluster:9200"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"xpack_enabled"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>
</div>

<p>The command below installs Kibana using a <code class="highlighter-rouge">options.json</code> file:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>dcos package install kibana --options<span class="o">=</span>options.json 
</code></pre>
</div>


</div>
</div>
</body>

</html>
